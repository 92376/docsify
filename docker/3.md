## 1. 安装上传文件工具

```shell
yum install lrzsz
```

## 2. linux工作目录`/root/cloud/`

上传jar包, 或其他配置文件.

```shell
# 上传文件，覆盖
rz -y
# 上传大文件，特殊字符
rz -be
```

## 3. Dockerfile

```dockerfile
FROM anapsix/alpine-java:8

ADD app.jar app.jar

EXPOSE 5000

ENTRYPOINT ["java", "-jar", "app.jar"]
```


## 4. 构建docker镜像脚本

### 1. `build-all.sh`构建当前目录下面的jar包(不包含app.jar).

```shell
#!/bin/bash

for jar in $(find *.jar);
do
if test $jar != "app.jar"
then
echo "构建$jar..."
cp -f $jar app.jar
docker build -t cloud_"${jar%.*}" . 
fi
done
rm -f app.jar
```

### 2. `build-two.sh`构建单个jar包

```shell
#!/bin/bash

read -p "输入jar包名:" name
file="${name%.jar}"
jar="$file.jar"
if [ ! -n "$file" ]
then
echo "jar包名不能为空"
else
if [ ! -f "$jar" ]
then
echo "jar包不存在"
else
echo "$jar"
cp -f "$jar" app.jar
docker build -t cloud_"$file" . 
rm -f app.jar
fi
fi
```

### 3. `build.sh`构建单个jar包

```shell
#!/bin/bash

file="${1%.jar}"
jar="$file.jar"
if [ ! -n "$file" ]
then
echo "参数:jar包名不能为空,忽略后缀"
else
if [ ! -f "$jar" ]
then
echo "参数:jar包不存在"
else
echo "$jar"
cp -f "$jar" app.jar
docker build -t cloud_"$file" . 
rm -f app.jar
fi
fi
```

### 4. 添加执行权限

```shell
chmod +x *.sh
```

### 5. 构建命令

>  说明: demo[.jar] jar包名, `.jar`为可选参数.

```shell
./build-all.sh

./build-two.sh
demo[.jar]

./build.sh demo[.jar]
```

## 6. 查看镜像

```shell
docker images
```

## 7. 运行镜像

>  **-p:** 指定端口映射，格式为：主机(宿主)端口:容器端口

```shell
docker run -itd -p 5000:5000 cloud_demo
```

